type Query {
  getChallenges: [Challenge]
  getActiveGame(
    player1: String!
    player2: String!
  ): Game 
  getOwnGames(
    player: String!
  ): [Game]
  getUser(username: String!): User
}

type Mutation {
  createChallenge(input: ChallengeInput!): Challenge
  deleteChallenge(creator: String!): Challenge
  createGame(input: GameInput!): Game
  finishGame(
    gameId: Int!
    player1Won: Boolean!
  ): Game
  sendMessage(input: MessageInput!): Message
  makeMove(input: MoveInput!): Move
  updateUser(input: UserInput!): User
}

type Subscription {
  onCreateChallenge: Challenge @aws_subscribe(mutations: ["createChallenge"])
  onDeleteChallenge: Challenge @aws_subscribe(mutations: ["deleteChallenge"])
  onCreateGame(challengeId: ID): Challenge @aws_subscribe(mutations: ["createGame"])
  onSendMessage(gameId: ID): Message @aws_subscribe(mutations: ["sendMessage"])
  onMakeMove(gameId: ID): Move @aws_subscribe(mutations: ["makeMove"])
}

type Challenge {
  id: ID!
  creator: String!
  rating: Int!
  boardSize: Int!
  duration: Int!
  timeIncrement: Int!
  isRated: Boolean!
  createdAt: AWSDateTime!
}

input ChallengeInput {
  id: ID
  boardSize: Int
  duration: Int 
  timeIncrement: Int 
  isRated: Boolean
}

type Game {
  id: ID!
  player1: String!
  player2: String!
  isRated: Boolean!
  boardSize: Int!
  duration: Int!
  timeIncrement: Int!
  oldRatingPlayer1: Int!
  oldRatingPlayer2: Int!
  newRatingPlayer1: Int
  newRatingPlayer2: Int
  player1Won: Boolean
  gameTerminated: Boolean
  createdAt: AWSDateTime!
}

input GameInput {
  id: ID
  challengeId: ID!
  player1: String!
  player2: String!
  isRated: Boolean
  boardSize: Int
  duration: Int
  timeIncrement: Int
  oldRatingPlayer1: Int!
  oldRatingPlayer2: Int!
}

type Message {
  id: ID!
  text: String!
  user: String!
  createdAt: AWSDateTime!
  gameId: ID!
}

input MessageInput {
  id: ID 
  text: String! 
  gameId: ID!
}

type Move {
  sender: String!
  type: MoveType!
  stonePosition: StonePosition
  gameId: ID!
  createdAt: AWSDateTime!
}

input MoveInput {
  type: MoveType!
  stonePosition: StonePosition
  gameId: ID! 
}

type StonePosition {
  x: Int!
  y: Int!
}

enum MoveType {
  MOVE
  PASS
  FORFEIT
  RESULT
}

type User {
  id: ID!
  username: String!
  email: String!
  firstname: String
  lastname: String
  createdAt: AWSDateTime!
  biography: String 
  country: String
  city: String
}

input UserInput {
  id: ID
  username: String!
  email: String
  firstname: String
  lastname: String
  biography: String
  country: String
  city: String
}